

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Zynq A9 programming in Python &mdash; Python on Zynq (Pynq) v1.0</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Python on Zynq (Pynq) v1.0" href="index.html"/>
        <link rel="next" title="Programming Zybo’s onboard peripherals" href="Programming_Zybo&#39;s_onboard_peripherals.html"/>
        <link rel="prev" title="Markdown Cells" href="d. Working With Markdown Cells.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Python on Zynq (Pynq)
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1.-Pynq.html">Pynq Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.-Getting-started.html">Start here</a></li>
<li class="toctree-l1"><a class="reference internal" href="a. What is the Jupyter Notebook.html">What is the Jupyter Notebook?</a></li>
<li class="toctree-l1"><a class="reference internal" href="b. Notebook Basics.html">Notebook Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="c. Running Code.html">Running Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="d. Working With Markdown Cells.html">Markdown Cells</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Zynq A9 programming in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-factors-and-primes-module">The factors_and_primes module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-built-in-functions">Using built-in functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#more-intensive-calculations">More intensive calculations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#programming-on-board-io">Programming on-board IO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#leds-switches-and-buttons">LEDs, switches and buttons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-a-single-led">Controlling a single LED</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-all-the-leds-switches-and-buttons">Controlling all the LEDs, switches and buttons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Programming_Zybo's_onboard_peripherals.html">Programming Zybo&#8217;s onboard peripherals</a></li>
<li class="toctree-l1"><a class="reference internal" href="pmodio_overlay (5).html">Peripherals and the PModIO overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.-The-PModIO-overlay.html">PMODs and the PModIO overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio_video_overlay.html">The Audio-Video Overlay</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.-Libraries-and-APIs.html">The <code class="docutils literal"><span class="pre">pyxi</span></code> (<strong>Py</strong>thon <strong>Xi</strong>linx) Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.-Libraries-and-APIs.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.-Test.html">Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="8.-Glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="9.-Useful-Reference-Links.html">Useful Reference Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="10.-FAQs.html">Frequently Asked Questions (FAQs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Appendix_1.html">Appendix 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">pynq</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Python on Zynq (Pynq)</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Zynq A9 programming in Python</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/3.-Programing-ZYBO-in-Python.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput > div,
div.nbinput div[class^=highlight],
div.nbinput div[class^=highlight] pre,
div.nboutput,
div.nboutput > div,
div.nboutput div[class^=highlight],
div.nboutput div[class^=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput > :first-child pre {
    color: navy;
}

/* output prompt */
div.nboutput > :first-child pre {
    color: darkred;
}

/* all prompts */
div.nbinput > :first-child[class^=highlight],
div.nboutput > :first-child[class^=highlight],
div.nboutput > :first-child {
    min-width: 11ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}

/* input/output area */
div.nbinput > :nth-child(2)[class^=highlight],
div.nboutput > :nth-child(2),
div.nboutput > :nth-child(2)[class^=highlight] {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
}

/* input area */
div.nbinput > :nth-child(2)[class^=highlight] {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput  > :nth-child(2).stderr {
    background: #fdd;
}

/* ANSI colors */
.ansiblack { color: black; }
.ansired { color: darkred; }
.ansigreen { color: darkgreen; }
.ansiyellow { color: #c4a000; }
.ansiblue { color: darkblue; }
.ansipurple { color: darkviolet; }
.ansicyan { color: steelblue; }
/* See https://github.com/jupyter/nbconvert/issues/174 */
.ansigray { color: gray; }  /* nbconvert CSS */
.ansigrey { color: gray; }  /* nbconvert HTML output */

.ansibgblack { background-color: black; }
.ansibgred { background-color: red; }
.ansibggreen { background-color: green; }
.ansibgyellow { background-color: yellow; }
.ansibgblue { background-color: blue; }
.ansibgpurple { background-color: magenta; }
.ansibgcyan { background-color: cyan; }
.ansibggray { background-color: gray; }

.ansibold { font-weight: bold; }
</style>
<div class="section" id="zynq-a9-programming-in-python">
<h1><a class="toc-backref" href="#id1">Zynq A9 programming in Python</a><a class="headerlink" href="#zynq-a9-programming-in-python" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#zynq-a9-programming-in-python" id="id1">Zynq A9 programming in Python</a><ul>
<li><a class="reference internal" href="#the-factors-and-primes-module" id="id2">The factors_and_primes module</a></li>
<li><a class="reference internal" href="#programming-on-board-io" id="id3">Programming on-board IO</a></li>
<li><a class="reference internal" href="#summary" id="id4">Summary</a></li>
</ul>
</li>
</ul>
</div>
<p>We show here some more examples of how to program the Xilinx Zynq 7010 APSoC on ZYBO using MicroPython.  The first set of examples run exclusively on the ARM Cortex-A9 processor.  These examples, which are based on calculating the factors and primes of integer numbers, give us a sense of the performance available with MicroPython running on a 650MHz Cortex-A9.</p>
<p>The second set of examples show how easy it is to program the A9 to control peripherals on the board.  The peripherals are interfaced to the processor by circuits in the programmable logic.  Together, the examples show how MicroPython implements a very substantial subset of the core Python capabilities. They also demonstrate the power of the MicroPython REPL, as a an interpreted interface to Zynq.</p>
<div class="section" id="the-factors-and-primes-module">
<h2><a class="toc-backref" href="#id2">The factors_and_primes module</a><a class="headerlink" href="#the-factors-and-primes-module" title="Permalink to this headline">¶</a></h2>
<p>The <cite>factors_and_primes</cite> module can be found in the pyxi.examples package.  It contains some sample functions to calculate the factors and primes of integers.  We will use three functions from the <cite>factors_and_primes</cite> module to demonstrate programming the ARM A9 CPU with MicroPython.</p>
<p>factorize(n)::
Calculate all factors of integer n
primes_between(interval_min, interval_max)::
Find all primes in the interval defined by interval_min, interval_max
print_ints_with_most_factors(interval_min, interval_max)::
Reports integers with most factors in a given integer range</p>
<p>Let&#8217;s start by importing the <cite>factors_and_primes</cite> module as <cite>fp</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">examples</span> <span class="kn">import</span> <span class="n">factors_and_primes</span> <span class="k">as</span> <span class="n">fp</span>
</pre></div>
</div>
<p>Next we will call the <cite>factorize()</cite> function to calculate the factors of an integer.</p>
<p><strong>factorize()</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span><span class="o">.</span><span class="n">factorize</span><span class="p">(</span><span class="mi">1066</span><span class="p">)</span>
<span class="go">[1, 2, 13, 26, 41, 82, 533, 1066]</span>
</pre></div>
</div>
<p>The <cite>primes_between()</cite> function can tell us how many prime numbers there are in an integer range.  Let&#8217;s try it for the interval 1 through 1066.</p>
<p><strong>primes_between()</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span><span class="o">.</span><span class="n">primes_between</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1066</span><span class="p">)</span>
<span class="go">[1, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269, 271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349, 353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431, 433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503, 509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599, 601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673, 677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761, 769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857, 859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947, 953, 967, 971, 977, 983, 991, 997, 1009, 1013, 1019, 1021, 1031, 1033, 1039, 1049, 1051, 1061, 1063]</span>
</pre></div>
</div>
<p>The answer is quite a few!  We can use one of Python&#8217;s built-in methods <cite>len()</cite> to count them all.</p>
<div class="section" id="using-built-in-functions">
<h3>Using built-in functions<a class="headerlink" href="#using-built-in-functions" title="Permalink to this headline">¶</a></h3>
<p>We can use one of Python&#8217;s built-in methods <cite>len()</cite> to count them the primes.</p>
<p><strong>len()</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">primes_between</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1066</span><span class="p">))</span>
<span class="go">180</span>
</pre></div>
</div>
<p>And we can combine <cite>len()</cite> with another built-in method, <cite>sum()</cite>, to calculate the average of the 180 prime numbers.</p>
<p><strong>sum()</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">primes_1066</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">primes_between</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1066</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">primes_1066</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">primes_1066</span><span class="p">)</span>
<span class="go">486.2056</span>
</pre></div>
</div>
<p>This result makes sense intuitively because prime numbers are known to become less frequent for larger number intervals.  These examples demonstrate how Python treats functions as first-class objects so that functions may be passed as parameters to other functions.  This is a key property of functional programming and demonstrates the power of Python (and MicroPython).</p>
<p>We can use list comprehensions (a &#8216;Pythonic&#8217; form of the map-filter-reduce template) to &#8216;mine&#8217; the factors of 1066 to find those factors that end in the digit &#8216;3&#8217;.</p>
<p><strong>str(), endswith()</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">fp</span><span class="o">.</span><span class="n">primes_between</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1066</span><span class="p">)</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;3&#39;</span><span class="p">)]</span>
<span class="go">[3, 13, 23, 43, 53, 73, 83, 103, 113, 163, 173, 193, 223, 233, 263, 283, 293, 313, 353, 373, 383, 433, 443, 463, 503, 523, 563, 593, 613, 643, 653, 673, 683, 733, 743, 773, 823, 853, 863, 883, 953, 983, 1013, 1033, 1063]</span>
</pre></div>
</div>
<p>This code tells MicroPython to first convert each prime between 1 and 1066 to a string and then to return those nu  mbers whose string representation end with the number &#8216;3&#8217;.  It uses the built-in <cite>str()</cite> and <cite>endswith()</cite> me  thods to test each prime for inclusion in the list.  A list of Python&#8217;s b</p>
<p>And because we really want to know what fraction of the 180 primes of 1066 end in a &#8216;3&#8217;, we can calculate  ...</p>
<p><strong>len(), str(), endswith()</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">primes_1066</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">primes_between</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1066</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">primes_1066</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;3&#39;</span><span class="p">)])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">primes_1066</span><span class="p">)</span>
<span class="go">0.25</span>
</pre></div>
</div>
<p>These examples demonstrate how Python is a modern, <em>multi-paradigmatic</em> language.  More simply, it continually integrates the best features of other leading languages, including functional programming constructs.  Consider how many lines of code you would need to implement the list comprehension above in C and you get an appreciation of the power of   <em>productivity-layer</em> languages.  Higher levels of programming abstraction really do result in higher programm  er productivity!</p>
</div>
<div class="section" id="more-intensive-calculations">
<h3>More intensive calculations<a class="headerlink" href="#more-intensive-calculations" title="Permalink to this headline">¶</a></h3>
<p>To stress the A9 a little more, we will run a script to determine the integer number, or numbers, that have the most factors between 1 and 1066, using the <cite>print_ints_with_most_factors()</cite> function from the <cite>factors_and_primes</cite> module.</p>
<p><strong>print_ints_with_most_factors()</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span><span class="o">.</span><span class="n">print_ints_with_most_factors</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1066</span>  <span class="p">)</span>

<span class="go">Between 1 and 1066 the number/s with the most factors:</span>

<span class="go">840 ... with the following 32 factors:</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 15, 20, 21, 24, 28, 30, 35, 40, 42, 56, 60, 70, 84, 105, 120, 140, 168, 210, 280, 420, 840]</span>
<span class="go">The prime number factors of 840 are: [1, 2, 3, 5, 7]</span>
</pre></div>
</div>
<p>The A9 remains quite responsive.  Running this for much larger numbers, say 50,000, will demonstrate noticeably slower responses as we would expect.</p>
<p>The source code for the functions above is available in the file <cite>examples/factors_and_primes.py</cite>  Reviewing the code wil l give you a better appreciation for the power of MicroPython both in terms of Python language covera  ge and performance.</p>
</div>
</div>
<div class="section" id="programming-on-board-io">
<h2><a class="toc-backref" href="#id3">Programming on-board IO</a><a class="headerlink" href="#programming-on-board-io" title="Permalink to this headline">¶</a></h2>
<div class="section" id="leds-switches-and-buttons">
<h3>LEDs, switches and buttons<a class="headerlink" href="#leds-switches-and-buttons" title="Permalink to this headline">¶</a></h3>
<p>ZYBO has four LEDs, four slide-switches and four push-buttons that are connected to the Zynq&#8217;s programmable logic.  These are highlighted in the photo of the ZYBO blow.</p>
<a class="reference internal image-reference" href="_images/zybo_io.jpeg"><img alt="_images/zybo_io.jpeg" class="align-center" src="_images/zybo_io.jpeg" style="width: 400.0px; height: 160.0px;" /></a>
<p>(Note that two additional push-buttons and 1 LED are connected directly to ZYBO&#8217;s processor system via memory IO pins.  These are not highlighted in the figure and we will ignore them for now.)</p>
<p>Each of the three banks of 4 IO devices can be controlled from Python.  To demonstrate this, we first import the <cite>LED</cite>, <cite>Switch</cite> and <cite>Button</cite> classes from the module <cite>pyxi.board</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Import libraries</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">pyxi.board</span> <span class="kn">import</span> <span class="n">LED</span><span class="p">,</span> <span class="n">Switch</span><span class="p">,</span> <span class="n">Button</span>
</pre></div>
</div>
</div>
<div class="section" id="controlling-a-single-led">
<h3>Controlling a single LED<a class="headerlink" href="#controlling-a-single-led" title="Permalink to this headline">¶</a></h3>
<p>Now we can instantiate instances of each of these classes and invoke their methods to manipulate them.  Let&#8217;s start by instantiating a single LED and turning it on and off.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">led0</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">led0</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">led0</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
</pre></div>
</div>
<p>Let&#8217;s toggle <cite>led0</cite> ten times.  We need to import the <cite>delay()</cite> method from the <cite>board</cite> module to allow us to see the led flashing.  A delay argument of 1 second is sufficient.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyxi.board</span> <span class="kn">import</span> <span class="n">LED</span><span class="p">,</span> <span class="n">Switch</span><span class="p">,</span> <span class="n">Button</span><span class="p">,</span> <span class="n">delay</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">led0</span> <span class="o">=</span> <span class="n">LED</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">led0</span><span class="o">.</span><span class="n">toggle</span><span class="p">()</span>
<span class="gp">... </span>   <span class="n">delay</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="controlling-all-the-leds-switches-and-buttons">
<h3>Controlling all the LEDs, switches and buttons<a class="headerlink" href="#controlling-all-the-leds-switches-and-buttons" title="Permalink to this headline">¶</a></h3>
<p>Next we create an example that uses the 4 LEDs, 4 slide-switches and 4 push-buttons. The script begins by turning all 4 LEDs off.  Then it samples the state of each of the 4 slide-switches and for any switch that is on, it lights the corresponding LED.  Finally, it checks the state of each of the 4 push-buttons and toggles the state of the corresponding LED.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pyxi.board</span> <span class="kn">import</span> <span class="n">LED</span><span class="p">,</span> <span class="n">Switch</span><span class="p">,</span> <span class="n">Button</span>

<span class="n">MAX_LEDS</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">MAX_SWITCHES</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">MAX_BUTTONS</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c"># Create lists for each of the IO component groups</span>
<span class="n">leds</span> <span class="o">=</span> <span class="p">[</span><span class="n">LED</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_LEDS</span><span class="p">)]</span>                 <span class="c"># (1)</span>
<span class="n">switches</span> <span class="o">=</span> <span class="p">[</span><span class="n">Switch</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_SWITCHES</span><span class="p">)]</span>
<span class="n">buttons</span> <span class="o">=</span> <span class="p">[</span><span class="n">Button</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">MAX_BUTTONS</span><span class="p">)]</span>

<span class="c"># LEDs start in the off state</span>
<span class="k">for</span> <span class="n">led</span> <span class="ow">in</span> <span class="n">leds</span><span class="p">:</span>
    <span class="n">led</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="c"># if a slide-switch is on, light the corresponding LED</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">switch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">switches</span><span class="p">):</span>                    <span class="c"># (2)</span>
    <span class="k">if</span> <span class="n">switch</span><span class="o">.</span><span class="n">read</span><span class="p">():</span>                                    <span class="c"># (3)</span>
        <span class="n">leds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">leds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="c"># if a button is depressed, toggle the state of the corresponding LED</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">button</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">buttons</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">button</span><span class="o">.</span><span class="n">read</span><span class="p">():</span>
        <span class="n">leds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">toggle</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple">
<li>The script uses list comprehensions to create 3 separate lists, called <cite>leds</cite>, <cite>switches</cite> and <cite>buttons</cite>, for the respective banks of IO components +</li>
<li>It then calls the built-in Python function, <cite>enumerate()</cite>, to access the index of a switch element, and the element itself, on each iteration through the loop +</li>
<li>The script invokes the <cite>read()</cite> method of a switch element to sample the state of the switch which is then transferred to the corresponding LED using the element index.</li>
</ol>
</div>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id4">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>We have used MicroPython to execute scripts that target both the PS and PL subsystems of Zynq.  Having established this core functionality, we are ready to extend our horizons by introducing more advanced features of overlays.  In the next section we will describe the PModIO overlay and demonstrate how to program it.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Programming_Zybo&#39;s_onboard_peripherals.html" class="btn btn-neutral float-right" title="Programming Zybo’s onboard peripherals" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="d. Working With Markdown Cells.html" class="btn btn-neutral" title="Markdown Cells" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Xilinx.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>